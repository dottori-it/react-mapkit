"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("react")),n=e(require("little-loader")),i=t.createContext({isInProvider:!1,mapkit:void 0}),a=function(e){var a=e.tokenOrCallback,r=e.language,o=e.children,u=t.useContext(i),c=t.useState({mapkit:u.mapkit,isInProvider:!0}),p=c[0],l=c[1];return t.useEffect((function(){u.isInProvider||n("https://cdn.apple-mapkit.com/mk/5.x.x/mapkit.js",(function(){var e=a.includes("/");mapkit.init({authorizationCallback:function(t){e?fetch(a).then((function(e){return e.text()})).then(t):t(a)},language:r}),l({mapkit:mapkit,isInProvider:!0})}))}),[u.isInProvider,a,r]),t.createElement(i.Provider,{value:p,children:o})};function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)t.indexOf(n=r[i])>=0||(a[n]=e[n]);return a}var u=function(e){return new mapkit.Padding("number"==typeof e?{top:e,right:e,bottom:e,left:e}:e)},c=function(e,t){return new mapkit.Coordinate(e,t)},p=function(e){return l(c(e.latitude,e.longitude),new mapkit.CoordinateSpan(e.latitudeSpan,e.longitudeSpan))},l=function(e,t){return new mapkit.CoordinateRegion(e,t)},d=function(e,t,n,i){return new mapkit.MapRect(e,t,n,i)},f=function(e){var t=e.padding,n=o(e,["padding"]);return r({padding:u(t||0)},n)},s=function(e){void 0===e&&(e={});var n=t.useState(e)[0],a=t.useContext(i).mapkit,l=t.useRef(null),f=t.useState(),s=f[0],m=f[1];return t.useEffect((function(){if(a&&l.current){var e=new a.Map(l.current,(i=(t=n).visibleMapRect,f=t.region,s=t.center,v=t.padding,k=o(t,["visibleMapRect","region","center","padding"]),r({visibleMapRect:i&&d.apply(void 0,i),region:f&&p(f),center:s&&c.apply(void 0,s),padding:u(v||0)},k)));m(e)}var t,i,f,s,v,k}),[l,a]),t.useEffect((function(){return function(){s&&s.destroy()}}),[]),{mapkit:a,map:s,mapProps:{mapkit:a,map:s,mapRef:l},setRotation:t.useCallback((function(e,t){void 0===t&&(t=!1),s&&s.setRotationAnimated(e,t)}),[s]),setCenter:t.useCallback((function(e,t){void 0===t&&(t=!1),s&&s.setCenterAnimated(c.apply(void 0,e),t)}),[s]),setRegion:t.useCallback((function(e,t){void 0===t&&(t=!1),s&&s.setRegionAnimated(p(e),t)}),[s]),setVisibleMapRect:t.useCallback((function(e,t){void 0===t&&(t=!1),s&&s.setVisibleMapRectAnimated(d.apply(void 0,e),t)}),[s])}},m=t.createContext({map:void 0,mapkit:void 0}),v=function(e){return t.createElement(m.Provider,{value:e.context,children:e.children})},k=function(e){return t.createElement("div",{ref:e.mapRef,style:{width:"100%",height:"100%"},children:e.children})},g=function(e){var n=e.children,i=o(e,["children"]),a=s(i).mapProps;return t.createElement(v,{context:{mapkit:a.mapkit,map:a.map}},t.createElement(k,{mapRef:a.mapRef,children:n}))};exports.Annotation=function(e){var n=e.latitude,i=e.longitude,a=e.factory,r=o(e,["latitude","longitude","factory"]),u=t.useContext(m),p=u.mapkit,l=u.map,d=t.useRef();return t.useEffect((function(){p&&l&&(d.current=new p.Annotation(c(n,i),a,f(r)),l.addAnnotation(d.current))}),[p,l,n,i,a,r]),null},exports.Map=function(e){var n=e.tokenOrCallback,r=e.language,u=void 0===r?"en":r,c=e.mapkit,p=e.map,l=e.mapRef,d=o(e,["tokenOrCallback","language","mapkit","map","mapRef"]),f=t.useContext(i);if(l)return t.createElement(v,{context:{mapkit:c,map:p}},t.createElement(k,Object.assign({mapRef:l},d)));var s=t.createElement(g,Object.assign({},d));if(f.isInProvider)return s;if(!n)throw new Error("`tokenOrCallback` is required. Either add it to this `Map` component or to a `MapkitProvider` parent of this component.");return t.createElement(a,{tokenOrCallback:n,language:u,children:s})},exports.MapContext=m,exports.MapkitContext=i,exports.MapkitProvider=a,exports.Marker=function(e){var n=e.latitude,i=e.longitude,a=o(e,["latitude","longitude"]),r=t.useContext(m),u=r.mapkit,p=r.map,l=t.useRef();return t.useEffect((function(){u&&p&&(l.current=new u.MarkerAnnotation(c(n,i),f(a)),p.addAnnotation(l.current))}),[u,p]),null},exports.useMap=s;
//# sourceMappingURL=react-mapkit.cjs.production.min.js.map
