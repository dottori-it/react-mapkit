"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("react")),n=e(require("little-loader")),i=t.createContext({isInProvider:!1,mapkit:void 0}),r=function(e){var r=e.tokenOrCallback,a=e.language,o=e.children,u=t.useContext(i),c=t.useState({mapkit:u.mapkit,isInProvider:!0}),p=c[0],l=c[1];return t.useEffect((function(){u.isInProvider||n("https://cdn.apple-mapkit.com/mk/5.x.x/mapkit.js",(function(){var e=r.includes("/");mapkit.init({authorizationCallback:function(t){e?fetch(r).then((function(e){return e.text()})).then(t):t(r)},language:a}),l({mapkit:mapkit,isInProvider:!0})}))}),[u.isInProvider,r,a]),t.createElement(i.Provider,{value:p,children:o})};function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)t.indexOf(n=a[i])>=0||(r[n]=e[n]);return r}var u=function(e){return new mapkit.Padding("number"==typeof e?{top:e,right:e,bottom:e,left:e}:e)},c=function(e,t){return new mapkit.Coordinate(e,t)},p=function(e){return l(c(e.latitude,e.longitude),new mapkit.CoordinateSpan(e.latitudeSpan,e.longitudeSpan))},l=function(e,t){return new mapkit.CoordinateRegion(e,t)},d=function(e,t,n,i){return new mapkit.MapRect(e,t,n,i)},s=function(e){void 0===e&&(e={});var n=t.useState(e)[0],r=t.useContext(i).mapkit,l=t.useRef(null),s=t.useState(),f=s[0],m=s[1];return t.useEffect((function(){if(r&&l.current){var e=new r.Map(l.current,(i=(t=n).visibleMapRect,s=t.region,f=t.center,v=t.padding,k=o(t,["visibleMapRect","region","center","padding"]),a({visibleMapRect:i&&d.apply(void 0,i),region:s&&p(s),center:f&&c.apply(void 0,f),padding:u(v||0)},k)));m(e)}var t,i,s,f,v,k}),[l,r]),t.useEffect((function(){return function(){f&&f.destroy()}}),[]),{mapkit:r,map:f,mapProps:{mapkit:r,map:f,mapRef:l},setRotation:t.useCallback((function(e,t){void 0===t&&(t=!1),f&&f.setRotationAnimated(e,t)}),[f]),setCenter:t.useCallback((function(e,t){void 0===t&&(t=!1),f&&f.setCenterAnimated(c.apply(void 0,e),t)}),[f]),setRegion:t.useCallback((function(e,t){void 0===t&&(t=!1),f&&f.setRegionAnimated(p(e),t)}),[f]),setVisibleMapRect:t.useCallback((function(e,t){void 0===t&&(t=!1),f&&f.setVisibleMapRectAnimated(d.apply(void 0,e),t)}),[f])}},f=t.createContext({map:void 0,mapkit:void 0}),m=function(e){return t.createElement(f.Provider,{value:e.context,children:e.children})},v=function(e){return t.createElement("div",{ref:e.mapRef,style:{width:"100%",height:"100%"},children:e.children})},k=function(e){var n=e.children,i=o(e,["children"]),r=s(i).mapProps;return t.createElement(m,{context:{mapkit:r.mapkit,map:r.map}},t.createElement(v,{mapRef:r.mapRef,children:n}))};exports.Map=function(e){var n=e.tokenOrCallback,a=e.language,u=void 0===a?"en":a,c=e.mapkit,p=e.map,l=e.mapRef,d=o(e,["tokenOrCallback","language","mapkit","map","mapRef"]),s=t.useContext(i);if(l)return t.createElement(m,{context:{mapkit:c,map:p}},t.createElement(v,Object.assign({mapRef:l},d)));var f=t.createElement(k,Object.assign({},d));if(s.isInProvider)return f;if(!n)throw new Error("`tokenOrCallback` is required. Either add it to this `Map` component or to a `MapkitProvider` parent of this component.");return t.createElement(r,{tokenOrCallback:n,language:u,children:f})},exports.MapContext=f,exports.MapkitContext=i,exports.MapkitProvider=r,exports.Marker=function(e){var n=e.latitude,i=e.longitude,r=o(e,["latitude","longitude"]),p=t.useContext(f),l=p.mapkit,d=p.map,s=t.useRef();return t.useEffect((function(){l&&d&&(s.current=new l.MarkerAnnotation(c(n,i),function(e){var t=e.padding,n=o(e,["padding"]);return a({padding:u(t||0)},n)}(r)),d.addAnnotation(s.current))}),[l,d]),null},exports.useMap=s;
//# sourceMappingURL=react-mapkit.cjs.production.min.js.map
